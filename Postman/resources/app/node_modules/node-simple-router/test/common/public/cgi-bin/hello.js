#!/usr/bin/env node

// Generated by CoffeeScript 1.4.0
(function() {
  var key, name, obj, qs, querystring, val;

  querystring = require('querystring');

  qs = process.env['QUERY_STRING'] || '';

  process.stdout.write("Content-Type: text/html\n\n");

  process.stdout.write("<h1 style='text-align: center;'>CGI greetings from JavaScript</h1>");

  if (qs === '') {
    process.stdout.write("<p>Hi, stranger. Regretably no data available for you.</p><p>Try adding a query string, something like '?name=Doomsday'</p>");
  } else {
    obj = querystring.parse(qs);
    name = obj.name || 'guest';
    process.stdout.write("<p>Welcome, " + name + ". Here is your data:</p>");
    process.stdout.write("<p><ul>");
    for (key in obj) {
      val = obj[key];
      process.stdout.write("<li>" + (key.toUpperCase()) + " = <strong>" + val + "</strong></li>");
    }
    process.stdout.write("</ul></p>");
  }

}).call(this);
